(()=>{"use strict";const t=document.getElementById("difficulty-selector"),e=document.getElementById("countdown"),n=document.getElementById("timer"),i=document.querySelector(".countdown-number"),d=(document.querySelector(".countdown-text"),document.querySelector(".time-display")),o=document.getElementById("end-timer");document.querySelector(".status-dot");let c=null,r=null,s=null;function a(){if(!c)return;const t=Date.now()-c;d.textContent=function(t){const e=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4),i=Math.floor(t%6e4/1e3);return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`}(t)}async function u(){const i=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];i.id&&s&&(c=Date.now(),r=window.setInterval(a,1e3),t.classList.add("hidden"),e.classList.add("hidden"),n.classList.remove("hidden"),chrome.runtime.sendMessage({type:"START_TIMER",difficulty:s,windowId:i.windowId,tabId:i.id}))}t.addEventListener("click",(function(n){const d=n.target;if(!d.matches(".difficulty-btn"))return;const o=d.getAttribute("data-difficulty");o&&(s=o,function(){let n=3;t.classList.add("hidden"),e.classList.remove("hidden"),i.textContent=n.toString();const d=setInterval((()=>{n--,n>0?i.textContent=n.toString():(clearInterval(d),u().then((()=>{setTimeout((()=>window.close()),300)})))}),800)}())})),o.addEventListener("click",(async function(){c&&(clearInterval(r),Date.now(),chrome.runtime.sendMessage({type:"END_TIMER"},(t=>{window.close()})))})),chrome.tabs.query({active:!0,currentWindow:!0},(([t])=>{t.id&&chrome.runtime.sendMessage({type:"GET_TIMER_STATE",tabId:t.id},(t=>{t.isActive&&t.startTime&&t.difficulty&&(s=t.difficulty,c=t.startTime,u())}))}))})();