{"version":3,"file":"content.js","sources":["../../src/contentScript.js"],"sourcesContent":["console.log('CodeClock: Content script loaded');\r\n\r\nlet timerContainer = null;\r\nlet isDragging = false;\r\nlet currentX;\r\nlet currentY;\r\nlet initialX;\r\nlet initialY;\r\nlet startTime;\r\n\r\n// Setup message listener for both development and production\r\nconst setupMessageListener = () => {\r\n  chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\r\n    console.log('CodeClock: Message received:', message);\r\n    if (message.type === 'START_TIMER') {\r\n      injectTimer(message.difficulty);\r\n      sendResponse({ status: 'Timer started' });\r\n    } else if (message.type === 'STOP_TIMER') {\r\n      removeTimer();\r\n      sendResponse({ status: 'Timer stopped' });\r\n    }\r\n    return true; // Keep the message channel open for sendResponse\r\n  });\r\n};\r\n\r\nsetupMessageListener();\r\n\r\n// Load saved position and time on init\r\nconst loadSavedState = () => {\r\n  const savedState = localStorage.getItem('codeclock_timer_state');\r\n  if (savedState) {\r\n    try {\r\n      const state = JSON.parse(savedState);\r\n      // Only restore if state is less than 24 hours old\r\n      if (Date.now() - state.timestamp < 24 * 60 * 60 * 1000) {\r\n        return state;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading saved state:', error);\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\nconst injectTimer = (difficulty) => {\r\n  console.log('CodeClock: Injecting timer for difficulty:', difficulty);\r\n  if (timerContainer) {\r\n    removeTimer();\r\n  }\r\n\r\n  const savedState = loadSavedState();\r\n  startTime = savedState ? Date.now() - (savedState.time * 1000) : Date.now();\r\n\r\n  timerContainer = document.createElement('div');\r\n  timerContainer.id = 'codeclock-timer-container';\r\n  \r\n  // Set initial position from saved state or default\r\n  const initialPosition = savedState?.position || { x: 20, y: 20 };\r\n  timerContainer.style.cssText = `\r\n    position: fixed;\r\n    top: ${initialPosition.y}px;\r\n    left: ${initialPosition.x}px;\r\n    z-index: 10000;\r\n    background: ${window.codeclock_colors.background.paper};\r\n    padding: 6px 12px;\r\n    border-radius: 20px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 8px;\r\n    width: fit-content;\r\n    max-width: 200px;\r\n    white-space: nowrap;\r\n    cursor: move;\r\n  `;\r\n\r\n  let time = savedState ? savedState.time : 0;\r\n  const updateTimer = () => {\r\n    time = Math.floor((Date.now() - startTime) / 1000);\r\n    const mins = Math.floor(time / 60);\r\n    const secs = time % 60;\r\n    timeText.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n    \r\n    // Save state every second\r\n    saveTimerState();\r\n  };\r\n\r\n  const saveTimerState = () => {\r\n    localStorage.setItem('codeclock_timer_state', JSON.stringify({\r\n      time,\r\n      difficulty,\r\n      position: {\r\n        x: parseInt(timerContainer.style.left),\r\n        y: parseInt(timerContainer.style.top)\r\n      },\r\n      timestamp: Date.now()\r\n    }));\r\n  };\r\n\r\n  // Create live indicator\r\n  const liveIndicator = document.createElement('div');\r\n  liveIndicator.style.cssText = `\r\n    width: 8px;\r\n    height: 8px;\r\n    background: #ff375f;\r\n    border-radius: 50%;\r\n    animation: pulse 1.5s infinite;\r\n  `;\r\n\r\n  // Add pulse animation\r\n  const style = document.createElement('style');\r\n  style.textContent = `\r\n    @keyframes pulse {\r\n      0% { opacity: 1; }\r\n      50% { opacity: 0.4; }\r\n      100% { opacity: 1; }\r\n    }\r\n  `;\r\n  document.head.appendChild(style);\r\n\r\n  // Create timer text\r\n  const timeText = document.createElement('div');\r\n  timeText.style.cssText = `\r\n    color: white;\r\n    font-family: monospace;\r\n    font-size: 14px;\r\n  `;\r\n\r\n  // Create stop button\r\n  const stopButton = document.createElement('button');\r\n  stopButton.innerHTML = '⏹';\r\n  stopButton.style.cssText = `\r\n    background: none;\r\n    border: none;\r\n    color: #ffa116;\r\n    cursor: pointer;\r\n    padding: 0;\r\n    font-size: 16px;\r\n  `;\r\n\r\n  stopButton.onclick = () => {\r\n    if (window.confirm('Are you sure you want to stop the timer?')) {\r\n      const message = {\r\n        type: 'TIMER_STOPPED',\r\n        data: { time, difficulty }\r\n      };\r\n      \r\n      chrome.runtime.sendMessage(message);\r\n      removeTimer();\r\n    }\r\n  };\r\n\r\n  timerContainer.appendChild(liveIndicator);\r\n  timerContainer.appendChild(timeText);\r\n  timerContainer.appendChild(stopButton);\r\n  document.body.appendChild(timerContainer);\r\n\r\n  // Start timer\r\n  const interval = setInterval(updateTimer, 1000);\r\n  timerContainer.dataset.interval = interval;\r\n\r\n  // Make timer draggable\r\n  timerContainer.addEventListener('mousedown', dragStart);\r\n  document.addEventListener('mousemove', drag);\r\n  document.addEventListener('mouseup', dragEnd);\r\n};\r\n\r\nconst removeTimer = () => {\r\n  if (timerContainer) {\r\n    clearInterval(Number(timerContainer.dataset.interval));\r\n    document.removeEventListener('mousemove', drag);\r\n    document.removeEventListener('mouseup', dragEnd);\r\n    timerContainer.remove();\r\n    timerContainer = null;\r\n    isDragging = false;\r\n    localStorage.removeItem('codeclock_timer_state');\r\n  }\r\n};\r\n\r\nfunction dragStart(e) {\r\n  if (!timerContainer) return;\r\n  initialX = e.clientX - timerContainer.offsetLeft;\r\n  initialY = e.clientY - timerContainer.offsetTop;\r\n  isDragging = true;\r\n}\r\n\r\nfunction drag(e) {\r\n  if (!isDragging || !timerContainer) return;\r\n  e.preventDefault();\r\n  currentX = e.clientX - initialX;\r\n  currentY = e.clientY - initialY;\r\n  timerContainer.style.left = currentX + \"px\";\r\n  timerContainer.style.top = currentY + \"px\";\r\n  saveTimerState();\r\n}\r\n\r\nfunction dragEnd() {\r\n  isDragging = false;\r\n} "],"names":["timerContainer","isDragging","currentX","currentY","initialX","initialY","startTime","setupMessageListener","message","sender","sendResponse","injectTimer","removeTimer","loadSavedState","savedState","state","error","difficulty","initialPosition","time","updateTimer","mins","secs","timeText","saveTimerState","liveIndicator","style","stopButton","interval","dragStart","drag","dragEnd","e"],"mappings":"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"}